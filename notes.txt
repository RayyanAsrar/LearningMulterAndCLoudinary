*What is multer?
-multer handles file upload in express
-Multer is middleware that processes multipart/form-data - the format browsers use to send files.
-we cannot handle files in req.body as it can only handle text
-u need to install multer (npm install multer)
-multer.diskStorage({}) , expects 2 things 
    1-destination 
        - WHERE to save the file
        -function (req, file, cb) {}
    2-filename
        -WHAT to name the file
        - file object contains:
            file.originalname: Original name from user's computer
            file.mimetype: File type (image/jpeg, application/pdf, etc.)
            file.fieldname: The name from your form's input field
-we do filter too we can restrict user from uploading every file types
- then we create an instance like below
                                    *** const upload =  multer({
                                        storage:storage,
                                        fileFilter:fileFilter,
                                        limits:{
                                            fileSize:1024*1024*5 //5MB  
                                        }
                                        }) ***
-upload.single()
                 - Accept only ONE file
                 - The file input field name must be 'profilePic'
-After multer processes the upload:
            - req.file contains the uploaded file info
            - req.body contains other form fields

-  req.file contains:
   {
     fieldname: 'profilePic',
     originalname: 'my-photo.jpg',
     encoding: '7bit',
     mimetype: 'image/jpeg',
     destination: './uploads',  
     filename: 'my-photo-1638472847362.jpg',
     path: 'uploads/my-photo-1638472847362.jpg',
     size: 245234 (in bytes)
   }
   
-app.post('/upload/multiple', upload.array('photos', 5), (req, res) => {
    -upload.array('photos', 5) means:
   - Accept multiple files
   - All from input field named 'photos'
   - Maximum 5 files
   -req.files (plural!) contains array of file objects  

-app.post('/upload/fields',upload.fields([{ name: 'profilePic', maxCount: 1 },{ name: 'coverPhoto', maxCount: 1 },{ name: 'documents', maxCount: 3 }]), (req, res) => {
    upload.fields() accepts multiple different fields
     Each field can have its own maxCount
     req.files is now an OBJECT (not array)
     {
       profilePic: [file1],
       coverPhoto: [file1],
       documents: [file1, file2, file3]
     }

---------------------------------------
-we use cloudinary to upload the files for cloud storage 
- first we do the cloudinary config and then we do the multer disk storage setup 
-then we create the multer instances 
-after that we we will create some helper functions so we donot have to wrtie the repetative code 
        example: upload and cleanup , delete local files 
- in file cloudinary.js at line 207-216 u will see this code 
                const result = await uploadAndCleanup(req.file.path, {
                            folder: 'user-profiles',
                            public_id: `profile_${Date.now()}`,
                            transformation: [
                                { width: 400, height: 400, crop: 'fill', gravity: 'face' },
                                { quality: 'auto' },
                                { fetch_format: 'auto' }
                            ],
                            overwrite: true
                        })
- in the first argument we will define the path and in the second we will define some of the options 
    -like the folder
    -public_id -> this key is ooptional if we dont pass this cloudinary will assign this a random key like "ab355nj"
    so its better to always pass a meaningfull key so it is easy to find in future  
    -next we pass a transformation key whoch defines the pic will be stored in storage
-when sending multiple files (req.files) always return array
                app.post('/api/upload/gallery',upload.array('photos',10),async(req,res)=>{
                const uploadedFiles = [];
                try {
                    console.log(req.files);  ---> returns array

                } catch (error) {
                    res.status(500).json({error:"server error",details:error.message});
                }
            })
            